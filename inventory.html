<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tamagotchi Pixel ‚Äî Inventory</title>
<style>
body{background:#071726;color:#fff;font-family:sans-serif;text-align:center;}
.btn{background:#10b981;color:#042018;padding:8px;margin:5px;border-radius:6px;border:0;cursor:pointer;}
.btn.alt{background:#06b6d4;}
.inventory-list{margin:10px auto;max-width:400px;text-align:left;}
.item{background:#0f1724;margin-bottom:8px;padding:8px;border-radius:6px;}
.link-nav{margin-top:10px;}
a{color:#10b981;text-decoration:none;font-weight:bold;}
</style>
</head>
<body>
<h1>üì¶ Inventory</h1>
<div id="inventory" class="inventory-list"></div>
<div class="link-nav">
  <a href="index.html">üè† Game</a> | 
  <a href="marketplace.html">üõí Marketplace</a>
</div>
<script>
const PLAYER_KEY = 'tama_player_v3';
const MARKET_KEY = 'tama_market_v3';
function loadPlayer(){ return JSON.parse(localStorage.getItem(PLAYER_KEY)) || null; }
function savePlayer(obj){ localStorage.setItem(PLAYER_KEY, JSON.stringify(obj)); }
function loadMarket(){ return JSON.parse(localStorage.getItem(MARKET_KEY)) || {}; }
function saveMarket(obj){ localStorage.setItem(MARKET_KEY, JSON.stringify(obj)); }

let player = loadPlayer();
let market = loadMarket();

if(!player.inventory) player.inventory = [];
// Tambahkan pet aktif ke inventory jika belum ada
if(player.activePet && !player.inventory.find(p=>p.id==='active')){
  player.inventory.push({id:'active', name:'Pet Kamu', evo:player.activePet.evo, alive:player.activePet.alive});
}

const invDiv = document.getElementById('inventory');

function renderInventory(){
  invDiv.innerHTML = '';
  if(player.inventory.length === 0){
    invDiv.innerHTML = '<div>Tidak ada pet</div>';
    return;
  }
  player.inventory.forEach((pet, i)=>{
    const div = document.createElement('div');
    div.className='item';
    div.innerHTML = `
      <div><strong>${pet.name}</strong> - ${pet.alive?'Hidup':'Mati'}</div>
      <button class="btn" onclick="setActive(${i})">Jadikan Aktif</button>
      <button class="btn alt" onclick="sellPet(${i})">Jual ke Market</button>
    `;
    invDiv.appendChild(div);
  });
}

function setActive(i){
  const pet = player.inventory[i];
  player.activePet = pet;
  savePlayer(player);
  alert('Pet aktif diganti!');
}

function sellPet(i){
  const pet = player.inventory[i];
  const price = prompt('Masukkan harga jual:');
  if(!price) return;
  const id = 'sale_'+Date.now();
  market[id] = {id,seller:player.name||'Player',price:parseInt(price),pet,offers:[]};
  saveMarket(market);
  player.inventory.splice(i,1);
  savePlayer(player);
  renderInventory();
  alert('Pet diposting di marketplace!');
}

renderInventory();
</script>
</body>
</html>
