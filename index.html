<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tamagotchi Pixel Online</title>
<style>
    body {
        background: linear-gradient(135deg, #89cff0, #ffffff);
        font-family: 'Press Start 2P', cursive;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
        text-align: center;
    }
    h1 { font-size: 20px; }
    .pet-container {
        width: 180px; height: 180px;
        background: #fefefe;
        border: 6px solid #333;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 10px;
    }
    .pet {
        display: grid;
        grid-template-columns: repeat(16, 8px);
        grid-template-rows: repeat(16, 8px);
    }
    .pixel { width: 8px; height: 8px; }
    .stats, .coins { font-size: 14px; margin: 6px 0; }
    .bars { width: 200px; margin: 8px 0; }
    .bar { height: 14px; background: #ddd; margin: 4px 0; border-radius: 3px; overflow: hidden; }
    .bar-inner { height: 100%; transition: width 0.5s; }
    .green { background: #4CAF50; }
    .red { background: #E91E63; }
    .buttons { display: flex; gap: 6px; margin-top: 8px; }
    button { padding: 6px 10px; background: #333; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    .marketplace {
        margin-top: 20px; padding: 10px;
        background: #fff; border: 2px solid #333; width: 240px;
    }
    .item {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 6px; font-size: 12px;
    }
</style>
</head>
<body>
<h1>Tamagotchi Pixel Online</h1>
<div class="coins">üí∞ Coin: <span id="coins">100</span></div>
<div class="pet-container"><div class="pet" id="pet"></div></div>
<div class="stats" id="stats">‚ù§Ô∏è 100 | üçñ 100</div>
<div class="bars">
    <div class="bar"><div class="bar-inner green" id="health-bar"></div></div>
    <div class="bar"><div class="bar-inner red" id="hunger-bar"></div></div>
</div>
<div class="buttons">
    <button onclick="feed()">Makan</button>
    <button onclick="play()">Main</button>
    <button onclick="sleep()">Tidur</button>
</div>

<div class="marketplace">
    <h3>Marketplace</h3>
    <div id="market-items">
        <div class="item"><span>üçé Makanan (+20)</span> <button onclick="buyItem('food')">10üí∞</button></div>
        <div class="item"><span>üß∏ Mainan (+15)</span> <button onclick="buyItem('toy')">15üí∞</button></div>
        <div class="item"><span>üíä Obat (+30)</span> <button onclick="buyItem('medicine')">25üí∞</button></div>
    </div>
</div>

<script>
const pet = document.getElementById("pet");
const stats = document.getElementById("stats");
const healthBar = document.getElementById("health-bar");
const hungerBar = document.getElementById("hunger-bar");
const coinsEl = document.getElementById("coins");

const COLORS = {
    stage1: "#FFD966",
    stage2: "#66FF66",
    stage3: "#66CCFF",
    eye: "#000",
    eyeBlink: "#fff",
    mouth: "#C21807",
    mouthOpen: "#FF0000",
    bg: "#fff"
};

let data = {
    health: 100,
    hunger: 100,
    coins: 100,
    evoStage: 1,
    sleeping: false
};

let evoTimer = 0;

function createSprite(stage, blink=false, talk=false) {
    const pixels = [];
    for (let i = 0; i < 256; i++) {
        let color = COLORS.bg;
        let bodyColor = COLORS.stage1;
        if (stage === 2) bodyColor = COLORS.stage2;
        if (stage === 3) bodyColor = COLORS.stage3;

        if (i > 35 && i < 220 && i % 16 > 2 && i % 16 < 13) color = bodyColor;
        if (i === 75 || i === 78 || i === 139 || i === 142) color = blink ? COLORS.eyeBlink : COLORS.eye;
        if (i === 187 || i === 188) color = talk ? COLORS.mouthOpen : COLORS.mouth;

        pixels.push(color);
    }
    return pixels;
}

function renderPet(blink=false, talk=false) {
    pet.innerHTML = "";
    const pixels = createSprite(data.evoStage, blink, talk);
    pixels.forEach(c => {
        const div = document.createElement("div");
        div.classList.add("pixel");
        div.style.backgroundColor = c;
        pet.appendChild(div);
    });
}

function updateUI() {
    stats.textContent = `‚ù§Ô∏è ${data.health} | üçñ ${data.hunger}`;
    healthBar.style.width = data.health + "%";
    hungerBar.style.width = data.hunger + "%";
    coinsEl.textContent = data.coins;
}

function feed() {
    if (!data.sleeping && data.coins >= 0) {
        data.hunger = Math.min(100, data.hunger + 20);
    }
    renderPet(false, true);
    setTimeout(() => renderPet(false, false), 500);
    updateUI();
}

function play() {
    if (!data.sleeping) {
        data.health = Math.min(100, data.health + 10);
        data.hunger = Math.max(0, data.hunger - 5);
    }
    renderPet(false, true);
    setTimeout(() => renderPet(false, false), 500);
    updateUI();
}

function sleep() {
    data.sleeping = !data.sleeping;
    updateUI();
}

function buyItem(item) {
    let cost = 0;
    if (item === 'food') cost = 10;
    if (item === 'toy') cost = 15;
    if (item === 'medicine') cost = 25;

    if (data.coins >= cost) {
        data.coins -= cost;
        if (item === 'food') data.hunger = Math.min(100, data.hunger + 20);
        if (item === 'toy') data.health = Math.min(100, data.health + 15);
        if (item === 'medicine') data.health = Math.min(100, data.health + 30);
        updateUI();
    } else {
        alert("Coin tidak cukup!");
    }
}

setInterval(() => {
    if (!data.sleeping) {
        data.hunger = Math.max(0, data.hunger - 1);
        data.health = Math.max(0, data.health - (data.hunger === 0 ? 2 : 0));
    }
    evoTimer += 3;
    if (evoTimer >= 60 && data.evoStage === 1) data.evoStage = 2;
    if (evoTimer >= 120 && data.evoStage === 2) data.evoStage = 3;

    renderPet();
    updateUI();
}, 3000);

renderPet();
updateUI();
</script>
</body>
</html>
