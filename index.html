<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tamagotchi Pixel Game</title>
<style>
  body{background:#08121a;color:#fff;font-family:sans-serif;text-align:center;padding:10px}
  canvas{background:#111;border-radius:8px;margin:10px auto;display:block;image-rendering:pixelated}
  button{padding:8px 12px;margin:6px;border:none;border-radius:6px;font-weight:bold;cursor:pointer}
  .green{background:#10b981;color:#042018}
  .blue{background:#3b82f6;color:#fff}
  .nav{margin-top:10px}
</style>
</head>
<body>
<h1>ğŸ£ Tamagotchi Pixel</h1>
<canvas id="gameCanvas" width="128" height="128" style="width:256px;height:256px"></canvas>
<div>Nama: <span id="playerName">-</span></div>
<div>Koin: <span id="coins">0</span></div>
<div>
  <button id="feedBtn" class="green">ğŸ Feed</button>
  <button id="sleepBtn" class="blue">ğŸ’¤ Sleep</button>
</div>
<div>
  <button id="tapBtn">ğŸ‘† Tap (Coin)</button>
  <button id="topupBtn">ğŸ’° Top-Up 100</button>
</div>
<div class="nav">
  <a href="inventory.html"><button>ğŸ“¦ Inventory</button></a>
  <a href="marketplace.html"><button>ğŸª Marketplace</button></a>
</div>
<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
ctx.imageSmoothingEnabled=false;

let player=JSON.parse(localStorage.getItem('player')||'null');
if(!player){
  player={name:prompt('Masukkan nama:'),coins:0,activePet:null,inventory:[]};
  // buat pet awal
  const pet={id:'pet'+Date.now(),name:'Chick',age:0,happy:true,status:'idle'};
  player.activePet=pet.id;
  player.inventory.push(pet);
  localStorage.setItem('player',JSON.stringify(player));
}

document.getElementById('playerName').innerText=player.name;
document.getElementById('coins').innerText=player.coins;

function save(){localStorage.setItem('player',JSON.stringify(player));}

function drawPet(){
  ctx.clearRect(0,0,128,128);
  ctx.fillStyle='#111';ctx.fillRect(0,0,128,128);
  const pet=player.inventory.find(p=>p.id===player.activePet);
  if(!pet){ctx.fillStyle='#fff';ctx.fillText('No Pet',40,64);return;}
  let color=pet.status==='sleep'?'#888':'#ffd07a';
  ctx.fillStyle=color;
  ctx.fillRect(40,50,48,48);
  ctx.fillStyle='#000';
  if(pet.status==='happy'){
    ctx.fillRect(52,64,6,6);
    ctx.fillRect(66,64,6,6);
    ctx.fillStyle='#ff69b4';
    ctx.fillRect(58,76,12,4);
  }else if(pet.status==='sad'){
    ctx.fillRect(52,64,6,6);
    ctx.fillRect(66,64,6,6);
    ctx.fillStyle='#00f';
    ctx.fillRect(58,76,12,2);
  }else if(pet.status==='sleep'){
    ctx.fillStyle='#000';
    ctx.fillRect(50,64,24,4);
  }else{
    ctx.fillRect(52,64,6,6);
    ctx.fillRect(66,64,6,6);
  }
}

drawPet();

// feed
feedBtn.onclick=()=>{
  const pet=player.inventory.find(p=>p.id===player.activePet);
  pet.status='happy';
  drawPet();
  setTimeout(()=>{pet.status='idle';drawPet();},2000);
  save();
};

// sleep
sleepBtn.onclick=()=>{
  const pet=player.inventory.find(p=>p.id===player.activePet);
  pet.status='sleep';
  drawPet();
  setTimeout(()=>{pet.status='idle';drawPet();},4000);
  save();
};

// tap farming
let tapBtn=document.getElementById('tapBtn');
tapBtn.onclick=()=>{
  player.coins+=1;
  document.getElementById('coins').innerText=player.coins;
  save();
};

document.getElementById('topupBtn').onclick=()=>{
  player.coins+=100;
  document.getElementById('coins').innerText=player.coins;
  save();
};
</script>
</body>
</html>
