<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Tamagotchi Pixel Pet</title>
  <style>
    body { text-align:center; font-family:sans-serif; background:#f0f9ff; }
    canvas { border:2px solid #333; background:#fff; margin-top:10px; }
    button { margin:5px; padding:10px 15px; border-radius:10px; cursor:pointer; }
  </style>
</head>
<body>
  <h1>üê£ Pixel Tamagotchi</h1>
  <p id="stats"></p>
  <canvas id="game" width="200" height="200"></canvas><br>
  <button onclick="feedPet()">üçé Feed</button>
  <button onclick="sellPet()">üí∏ Sell Pet</button>
  <button onclick="buyPet()">üõí Buy Pet</button>

  <script>
  let canvas = document.getElementById("game");
  let ctx = canvas.getContext("2d");

  // save data
  let save = JSON.parse(localStorage.getItem("petSave")) || {
    name: "Pet001",
    level: 1,
    xp: 0,
    age: 0,
    lastFed: 0,
    birthday: Date.now(),
    owner: "Player-" + Math.floor(Math.random()*1000)
  };

  // evolusi pet berdasarkan level
  function drawPet(x){
    ctx.font = "40px monospace";
    if(save.level < 3){
      ctx.fillText("üê§",x,100); // bayi
    } else if(save.level < 5){
      ctx.fillText("üêá",x,100); // remaja
    } else {
      ctx.fillText("üêâ",x,100); // dewasa naga
    }
  }

  let dir = 1, posX = 50;

  function loop(){
    ctx.clearRect(0,0,200,200);
    posX += dir*2;
    if(posX>150 || posX<10) dir*=-1;
    drawPet(posX);

    // update umur
    let days = Math.floor((Date.now()-save.birthday)/(1000*60*60*24));
    save.age = days;

    // naik level setiap 7 hari
    let weeks = Math.floor(days/7)+1;
    if(weeks > save.level){
      save.level = weeks;
    }

    document.getElementById("stats").innerText =
      `Name: ${save.name} | Age: ${save.age}d | Level: ${save.level} | Owner: ${save.owner}`;
    
    localStorage.setItem("petSave",JSON.stringify(save));
    requestAnimationFrame(loop);
  }
  loop();

  // makan setiap 30 menit
  function feedPet(){
    let now = Date.now();
    if(now - save.lastFed < 30*60*1000){
      alert("Pet masih kenyang! Tunggu 30 menit lagi.");
      return;
    }
    save.lastFed = now;
    alert("Yummy! Pet makan dengan lahap üçé");
  }

  // sistem jual beli sederhana
  function sellPet(){
    let id = prompt("Masukkan ID unik untuk jual pet ini:");
    if(!id) return;
    localStorage.setItem("market_"+id,JSON.stringify(save));
    alert("Pet dimasukkan ke pasar dengan ID: "+id);
  }

  function buyPet(){
    let id = prompt("Masukkan ID pet yang ingin dibeli:");
    let pet = JSON.parse(localStorage.getItem("market_"+id));
    if(!pet){ alert("Pet tidak ditemukan di pasar!"); return; }
    save = pet;
    save.owner = "Player-" + Math.floor(Math.random()*1000);
    localStorage.setItem("petSave",JSON.stringify(save));
    alert("Berhasil membeli pet dengan ID: "+id);
  }
  </script>
</body>
</html>
