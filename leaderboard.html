<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Leaderboard — Tamagotchi</title>
<style>
  body{background:#0b1220;color:#fff;font-family:sans-serif;text-align:center}
  .panel{background:#101a2b;padding:12px;border-radius:10px;margin:12px auto;max-width:640px}
  .item{background:#1a2436;padding:8px;border-radius:8px;margin:6px 0}
  input,button{padding:8px;border-radius:8px;border:0;margin:4px}
  .menu a, .menu button { display:inline-block;background:#1f2937;color:#fff;text-decoration:none;padding:8px 10px;margin:4px;border-radius:8px;border:0 }
</style>
</head>
<body>
<h2>🏆 Leaderboard</h2>
<div class="menu">
  <a href="index.html">🏠 Home</a>
  <a href="inventory.html">📦 Inventory</a>
  <a href="marketplace.html">🏪 Marketplace</a>
  <a href="chat.html">💬 Chat</a>
  <button onclick="logout()">🚪 Logout</button>
</div>

<div class="panel">
  <input id="q" placeholder="Cari pemain..." oninput="render()"/>
  <div id="board"></div>
</div>

<script>
let players=JSON.parse(localStorage.getItem('players')||'{}');
let currentUser=localStorage.getItem('sessionUser');
if(!currentUser || !players[currentUser]) location.href='index.html';
function logout(){ localStorage.removeItem('sessionUser'); location.href='index.html'; }

function render(){
  const q=(document.getElementById('q').value||'').toLowerCase();
  const arr=Object.entries(players).map(([name,p])=>{
    return { name, coins:p.coins||0, level:p.pet?p.pet.level:0, pets:(p.inventory||[]).length };
  });
  arr.sort((a,b)=> b.level - a.level || b.coins - a.coins);
  const board=document.getElementById('board');
  board.innerHTML = arr
    .filter(r=>!q || r.name.toLowerCase().includes(q))
    .map(r=>`<div class="item"><b>${r.name}</b> — Lv ${r.level} | 💰 ${r.coins} | Koleksi ${r.pets}</div>`)
    .join('') || '<p>Belum ada pemain</p>';
}
render();
</script>
</body>
</html>
