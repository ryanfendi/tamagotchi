<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leaderboard — Tamagotchi Online</title>
<style>
  body{background:#0b1220;color:#fff;font-family:sans-serif;text-align:center;padding:16px}
  .panel{background:#101a2b;border-radius:12px;padding:12px;margin:10px auto;max-width:680px}
  .item{background:#0f172a;border-radius:10px;padding:10px;margin:8px 0;text-align:left}
  input{padding:8px;border-radius:8px;border:0;margin:4px;min-width:220px}
  button{background:#10b981;border:0;border-radius:8px;color:#042018;font-weight:700;padding:8px 10px;margin:4px;cursor:pointer}
  .row{display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}
</style>
</head>
<body>
  <h2>🏆 Leaderboard</h2>
  <div class="panel">
    <div class="row">
      <div>
        <input id="search" placeholder="Cari email..." oninput="render()">
      </div>
      <div>
        <button onclick="go('index.html')">🏠 Home</button>
        <button onclick="go('inventory.html')">📦 Inventory</button>
        <button onclick="go('marketplace.html')">🏪 Marketplace</button>
        <button onclick="go('chat.html')">💬 Chat</button>
      </div>
    </div>
  </div>
  <div class="panel" id="list">Memuat...</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script>
const firebaseConfig = {
  apiKey:"AIzaSyAN0GNZdIx_xPHT7MZKWJweLtNhies6QxY",
  authDomain:"tamagotchi-2be0c.firebaseapp.com",
  databaseURL:"https://tamagotchi-2be0c-default-rtdb.firebaseio.com",
  projectId:"tamagotchi-2be0c",
  storageBucket:"tamagotchi-2be0c.firebasestorage.app",
  messagingSenderId:"202052432703",
  appId:"1:202052432703:web:cb76b50e42149a2c92998a",
  measurementId:"G-TWGGSJRX26"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

let rows=[];

db.ref('profiles').on('value', snap=>{
  rows=[];
  if(snap.exists()){
    const v=snap.val();
    for(const k in v){ rows.push({uid:k, ...v[k]}); }
  }
  render();
});

function render(){
  const term=(document.getElementById('search').value||'').toLowerCase();
  const list=document.getElementById('list'); list.innerHTML='';
  const data = rows
    .filter(r=>!term || (r.email||'').toLowerCase().includes(term))
    .sort((a,b)=>(b.level||0)-(a.level||0) || (b.coins||0)-(a.coins||0))
    .slice(0,100);

  if(data.length===0){ list.innerHTML='<p>Tidak ada data.</p>'; return; }

  data.forEach((r,i)=>{
    const el=document.createElement('div'); el.className='item';
    el.innerHTML=`<div class="row">
      <div><b>#${i+1}</b> — ${r.email||r.uid}</div>
      <div>Level: <b>${r.level||1}</b> · Coin: <b>${(r.coins||0).toFixed?.(2)||r.coins||0}</b></div>
    </div>`;
    list.appendChild(el);
  });
}

function go(p){ location.href=p; }
</script>
</body>
</html>
