<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tamagotchi Online — Owner Panel</title>
<style>
  body{background:#0b1220;color:#fff;font-family:sans-serif;text-align:center}
  .wrap{max-width:720px;margin:0 auto;padding:12px}
  .panel{background:#101a2b;border-radius:12px;padding:14px;margin:10px;text-align:left}
  .menu a,.menu button{background:#1f2937;color:#fff;text-decoration:none;padding:8px 10px;border-radius:10px;border:0;display:inline-block;margin:4px}
  input,button{padding:10px;border-radius:10px;border:0;margin:4px}
  button{background:#10b981;color:#042018;font-weight:700}
  .warn{color:#fca5a5}
</style>
</head>
<body>
<div class="wrap">
  <h2>🛠️ Owner Panel</h2>
  <div class="menu">
    <a href="index.html">🏠 Home</a>
    <button id="btnLogout">🚪 Logout</button>
  </div>

  <div id="guard" class="panel">Memeriksa akses...</div>

  <div id="ownerUI" class="panel" style="display:none">
    <h3>Top-up Coin</h3>
    <input id="tuUser" placeholder="Nama player">
    <input id="tuAmt" type="number" placeholder="Jumlah coin">
    <button id="btnTopup">Top-up</button>
    <hr>
    <h3>Set Level Pet Aktif</h3>
    <input id="lvUser" placeholder="Nama player">
    <input id="lvNum" type="number" placeholder="Level">
    <button id="btnSetLv">Set Level</button>
    <hr>
    <h3 class="warn">Hapus Player</h3>
    <input id="delUser" placeholder="Nama player">
    <button id="btnDel" class="warn">Hapus</button>
  </div>
</div>

<script type="module" src="js/firebase-config.js"></script>
<script type="module" src="js/online.js"></script>
<script type="module">
import { onAuth, logout, isOwner, ownerTopup, ownerSetLevel, ownerDeletePlayer } from './js/online.js';
document.getElementById('btnLogout').onclick = ()=> logout();
const guard = document.getElementById('guard');
const panel = document.getElementById('ownerUI');

onAuth(async (user)=>{
  if(!user){ location.href='index.html'; return; }
  if(!(await isOwner(user.uid))){
    guard.textContent = 'Akses ditolak. Khusus OWNER.'; return;
  }
  guard.style.display='none'; panel.style.display='block';
});

document.getElementById('btnTopup').onclick = async ()=>{
  try{
    await ownerTopup(document.getElementById('tuUser').value, document.getElementById('tuAmt').value);
    alert('Top-up berhasil');
  }catch(e){ alert(e.message); }
};
document.getElementById('btnSetLv').onclick = async ()=>{
  try{
    await ownerSetLevel(document.getElementById('lvUser').value, document.getElementById('lvNum').value);
    alert('Level diset');
  }catch(e){ alert(e.message); }
};
document.getElementById('btnDel').onclick = async ()=>{
  if(!confirm('Yakin hapus?')) return;
  try{
    await ownerDeletePlayer(document.getElementById('delUser').value);
    alert('Player dihapus');
  }catch(e){ alert(e.message); }
};
</script>
</body>
</html>
